@model ProductsListViewModel

<div class="table-responsive rounded">
	<table class="table table-striped table-bordered table-hover table-condensed table-sm table-active table-secondary">
		<thead class="thead-dark">
			<tr>
				<th style="width:30%;"></th>
				<th style="width:12%;">Name</th>
				<th style="width:12%;">Price</th>
				<th style="width:12%;">Quantity</th>
				<th style="width:12%;">Active</th>
				<th style="width:12%;">Status</th>
			</tr>
		</thead>
		<tbody>
			@{
				ECommerceService eCommerce = (ECommerceService)ViewData[GlobalViewBagKeys.ECommerceService];
				string formAction=Url.Action("ChangeProductActive","Seller");
				foreach (ProductView product in Model.Products)
				{
					<tr class="sellerProductTableRow">
						<td><img file-content="product.RepresentativeImage" /></td>
						<td>@product.ProductTypeName</td>
						<td>@CurrencyFormat.Format(product.Price)</td>
						<td>@product.Quantity</td>
						<td>
							<form action="@formAction" method="post">
								<input type="hidden" name="productTypeId" value="@product.ProductTypeId" />
								<input @(product.Active ? "checked" : "") class="submitOnChange" name="active"
										type="checkbox" data-toggle="toggle" value="true"
										data-onstyle="success" data-offstyle="danger" data-size="small"
										data-on="<i class='fas fa-lock-open'></i>"
										data-off="<i class='fa fa-lock'></i>" />
							</form>
						</td>
						<td>@product.Status</td>
						<td>
							<a asp-action="UpdateProduct" asp-route-productTypeId="@product.ProductTypeId" class="btn btn-warning">Edit</a>
							<a href="#" class="btn btn-danger">Change Operating Model</a>
						</td>
					</tr>
				}
			}
		</tbody>
	</table>
</div>

<div page-model="Model.PagingInfo" page-action="@ViewContext.RouteData.Values["Action"].ToString()" class="col-12"
	 page-class="page-item" page-class-normal=""
	 page-class-selected="active" page-class-disabled="disabled">
</div>

<script type="text/javascript">
	//change user state

	$('.submitOnChange').change(function () {
		var $form = $(this).closest('form');
		$.ajax({
			url: $form.attr('action'),
			type: $form.attr('method'),
			data: $form.serialize(),
			success: function (result) {
				if (result != '')
					alert(result);
			},
			error: function (result) {
				alert('something went wrong while changing product active:\n' + result);
			}
		});
	});
</script>